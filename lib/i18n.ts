import * as Localization from 'expo-localization';

import i18n from 'i18next';
import { initReactI18next } from 'react-i18next';

const resources = {
  en: {
    translation: {
      settings: {
        title: 'Settings',
        apiUrl: 'API URL',
        apiUrlPlaceholder: 'https://spuml.mewis.me',
        apiUrlNote: 'Note: When using a custom API URL, you need to run a local PlantUML server. Please clone and run the project above to render PlantUML diagrams.',
        autoRender: 'Auto Render',
        autoRenderDescription: 'Auto render after 300ms when format is valid',
        hapticFeedback: 'Haptic Feedback',
        hapticFeedbackDescription: 'Enable haptic feedback when rendering succeeds or AI returns response',
        darkMode: 'Dark Mode',
        darkModeDescription: 'Toggle dark mode',
        language: 'Language',
        languageDescription: 'Select app language',
        appUpdates: {
          title: 'App Updates',
          description: 'Check for app updates and apply them when available.',
          checkForUpdates: 'Check for Updates',
          applyUpdate: 'Apply Update',
          updateAvailable: 'Update available! Download it to apply.',
          updateDownloaded: 'Update downloaded! Restart the app to apply.',
          noUpdates: 'No Updates',
          noUpdatesMessage: 'You are using the latest version.',
          error: 'Error',
          errorMessage: 'Failed to check for updates. Please try again later.',
          updateAvailableTitle: 'Update Available',
          updateAvailableMessage: 'A new update is available. Would you like to download it?',
          download: 'Download',
          cancel: 'Cancel',
          updateDownloadedTitle: 'Update Downloaded',
          updateDownloadedMessage: 'The update has been downloaded. The app will restart to apply the update.',
          restartNow: 'Restart Now',
          later: 'Later',
          restartRequired: 'Restart Required',
          restartRequiredMessage: 'The app will restart to apply the update.',
          downloadError: 'Failed to download update. Please try again later.',
        },
        aiSettings: {
          title: 'AI Settings',
          provider: 'Provider',
          selectProvider: 'Select provider',
          baseUrl: 'Base URL',
          baseUrlPlaceholder: 'https://api.example.com/v1',
          model: 'Model',
          selectModel: 'Select model',
          enterModelName: 'Enter model name',
          noModelsAvailable: 'No models available',
          apiKey: 'API Key',
          apiKeyPlaceholder: 'Enter your API key',
        },
      },
      home: {
        title: 'Enter PUML Code',
        plantUmlDiagram: 'PlantUML Diagram',
        error: 'Error',
        paste: 'Paste',
        render: 'Render',
        explain: 'Explain',
        optimize: 'Optimize',
        explainResult: 'Explanation',
        optimizeResult: 'Optimized Code',
        renderResult: 'Render Result',
        preview: 'Preview',
        renderId: 'Render ID',
        viewPreview: 'View preview',
        png: 'PNG',
        svg: 'SVG',
        text: 'Text',
        downloadPng: 'Download PNG',
        rawView: 'Raw View',
        share: 'Share',
        pleaseEnterPumlCode: 'Please enter PUML code',
        cannotLoadPreview: 'Cannot load preview',
        errorOccurredWhileRendering: 'An error occurred while rendering',
        errorOccurredWhileExplaining: 'An error occurred while explaining',
        errorOccurredWhileOptimizing: 'An error occurred while optimizing',
        cannotReadClipboard: 'Cannot read clipboard',
        permissionDeniedToSave: 'Permission denied to save to gallery',
        pngSavedToAlbum: 'PNG saved to PUML Viewer album',
        cannotDownloadFile: 'Cannot download file',
        urlCopiedToClipboard: 'URL copied to clipboard',
        textCopiedToClipboard: 'Text copied to clipboard',
        cannotShare: 'Cannot share',
        success: 'Success',
        pleaseSetApiKey: 'Please set your API key in Settings',
        pleaseSetApiBaseUrl: 'Please set your API base URL in Settings',
        useOptimizedCode: 'Use Optimized Code',
        close: 'Close',
        clear: 'Clear',
        clearConfirm: 'Are you sure you want to clear all content?',
      },
      about: {
        title: 'About',
        madeBy: 'Made by',
        withLove: 'with love.',
        statistics: 'Statistics',
        totalDiagrams: 'Total Diagrams',
        favorites: 'Favorites',
      },
      history: {
        title: 'History',
        clearAll: 'Clear All',
        search: 'Search',
        searchPlaceholder: 'Search...',
        filter: 'Filter',
        all: 'All',
        favorites: 'Favorites',
        noHistoryYet: 'No history yet',
        noItemsFound: 'No items found',
        enterTitleOptional: 'Enter title (optional)',
        save: 'Save',
        cancel: 'Cancel',
        copy: 'Copy',
        qr: 'QR',
        delete: 'Delete',
        codeCopiedToClipboard: 'Code copied to clipboard',
        error: 'Error',
        cannotCopyToClipboard: 'Cannot copy to clipboard',
        deleteConfirm: 'Are you sure you want to delete this item?',
        clearAllConfirm: 'Are you sure you want to clear all history?',
        pumlDiagram: 'PUML Diagram',
        failedToGenerateQrCode: 'Failed to generate QR code',
        success: 'Success',
      },
      ai: {
        title: 'AI Assistant',
        startConversation: 'Start a conversation with AI to generate PlantUML diagrams. Ask me to create diagrams like sequence diagrams, class diagrams, or any other PlantUML diagram.',
        you: 'You',
        ai: 'AI',
        render: 'Render',
        error: 'Error',
        askAiPlaceholder: 'Ask AI to generate a PlantUML diagram...',
        pleaseSetApiKey: 'Please set your API key in Settings',
        pleaseSetApiBaseUrl: 'Please set your API base URL in Settings',
        errorOccurredWhileGenerating: 'An error occurred while generating',
        failedToRenderPumlCode: 'Failed to render PUML code',
      },
      tabs: {
        pumlViewer: 'PUML Viewer',
        home: 'Home',
        ai: 'AI',
        aiAssistant: 'AI Assistant',
        history: 'History',
        settings: 'Settings',
        about: 'About',
      },
      pumlViewer: {
        title: 'PUML Viewer',
        loadingPumlDiagram: 'Loading PUML diagram...',
        error: 'Error',
        failedToLoadDiagram: 'Failed to load diagram',
        goToHome: 'Go to Home',
      },
      notFound: {
        title: 'Not Found',
        pageNotFound: 'Page Not Found',
        oopsPageDoesNotExist: "Oops! This page doesn't exist.",
        pageNotFoundMessage: "The page you're looking for could not be found.",
        goToHome: 'Go to Home',
      },
    },
  },
  vi: {
    translation: {
      settings: {
        title: 'Cài đặt',
        apiUrl: 'URL API',
        apiUrlPlaceholder: 'https://spuml.mewis.me',
        apiUrlNote: 'Lưu ý: Khi sử dụng URL API tùy chỉnh, bạn cần chạy máy chủ PlantUML cục bộ. Vui lòng clone và chạy dự án ở trên để render sơ đồ PlantUML.',
        autoRender: 'Tự động Render',
        autoRenderDescription: 'Tự động render sau 300ms khi định dạng hợp lệ',
        hapticFeedback: 'Phản hồi rung',
        hapticFeedbackDescription: 'Bật phản hồi rung khi render thành công hoặc AI trả về phản hồi',
        darkMode: 'Chế độ tối',
        darkModeDescription: 'Bật/tắt chế độ tối',
        language: 'Ngôn ngữ',
        languageDescription: 'Chọn ngôn ngữ cho ứng dụng',
        appUpdates: {
          title: 'Cập nhật ứng dụng',
          description: 'Kiểm tra và áp dụng cập nhật ứng dụng khi có sẵn.',
          checkForUpdates: 'Kiểm tra cập nhật',
          applyUpdate: 'Áp dụng cập nhật',
          updateAvailable: 'Có cập nhật! Tải xuống để áp dụng.',
          updateDownloaded: 'Đã tải xuống cập nhật! Khởi động lại ứng dụng để áp dụng.',
          noUpdates: 'Không có cập nhật',
          noUpdatesMessage: 'Bạn đang sử dụng phiên bản mới nhất.',
          error: 'Lỗi',
          errorMessage: 'Không thể kiểm tra cập nhật. Vui lòng thử lại sau.',
          updateAvailableTitle: 'Có cập nhật',
          updateAvailableMessage: 'Có cập nhật mới. Bạn có muốn tải xuống không?',
          download: 'Tải xuống',
          cancel: 'Hủy',
          updateDownloadedTitle: 'Đã tải xuống cập nhật',
          updateDownloadedMessage: 'Cập nhật đã được tải xuống. Ứng dụng sẽ khởi động lại để áp dụng cập nhật.',
          restartNow: 'Khởi động lại ngay',
          later: 'Để sau',
          restartRequired: 'Cần khởi động lại',
          restartRequiredMessage: 'Ứng dụng sẽ khởi động lại để áp dụng cập nhật.',
          downloadError: 'Không thể tải xuống cập nhật. Vui lòng thử lại sau.',
        },
        aiSettings: {
          title: 'Cài đặt AI',
          provider: 'Nhà cung cấp',
          selectProvider: 'Chọn nhà cung cấp',
          baseUrl: 'URL cơ sở',
          baseUrlPlaceholder: 'https://api.example.com/v1',
          model: 'Mô hình',
          selectModel: 'Chọn mô hình',
          enterModelName: 'Nhập tên mô hình',
          noModelsAvailable: 'Không có mô hình nào',
          apiKey: 'Khóa API',
          apiKeyPlaceholder: 'Nhập khóa API của bạn',
        },
      },
      home: {
        title: 'Nhập mã PUML',
        plantUmlDiagram: 'Sơ đồ PlantUML',
        error: 'Lỗi',
        paste: 'Dán',
        render: 'Kết xuất',
        explain: 'Giải thích',
        optimize: 'Tối ưu hóa',
        explainResult: 'Giải thích',
        optimizeResult: 'Mã đã tối ưu',
        renderResult: 'Kết quả kết xuất',
        preview: 'Xem trước',
        renderId: 'Mã kết xuất',
        viewPreview: 'Xem trước',
        png: 'PNG',
        svg: 'SVG',
        text: 'Văn bản',
        downloadPng: 'Tải PNG',
        rawView: 'Xem nguyên bản',
        share: 'Chia sẻ',
        pleaseEnterPumlCode: 'Vui lòng nhập mã PUML',
        cannotLoadPreview: 'Không thể tải xem trước',
        errorOccurredWhileRendering: 'Đã xảy ra lỗi khi kết xuất',
        errorOccurredWhileExplaining: 'Đã xảy ra lỗi khi giải thích',
        errorOccurredWhileOptimizing: 'Đã xảy ra lỗi khi tối ưu hóa',
        cannotReadClipboard: 'Không thể đọc clipboard',
        permissionDeniedToSave: 'Không có quyền lưu vào thư viện',
        pngSavedToAlbum: 'PNG đã được lưu vào album PUML Viewer',
        cannotDownloadFile: 'Không thể tải file',
        urlCopiedToClipboard: 'URL đã được sao chép vào clipboard',
        textCopiedToClipboard: 'Văn bản đã được sao chép vào clipboard',
        cannotShare: 'Không thể chia sẻ',
        success: 'Thành công',
        pleaseSetApiKey: 'Vui lòng đặt khóa API trong Cài đặt',
        pleaseSetApiBaseUrl: 'Vui lòng đặt URL cơ sở API trong Cài đặt',
        useOptimizedCode: 'Sử dụng mã đã tối ưu',
        close: 'Đóng',
        clear: 'Xóa',
        clearConfirm: 'Bạn có chắc chắn muốn xóa tất cả nội dung?',
      },
      about: {
        title: 'Giới thiệu',
        madeBy: 'Được tạo bởi',
        withLove: 'với tình yêu.',
        statistics: 'Thống kê',
        totalDiagrams: 'Tổng số sơ đồ',
        favorites: 'Yêu thích',
      },
      history: {
        title: 'Lịch sử',
        clearAll: 'Xóa tất cả',
        search: 'Tìm kiếm',
        searchPlaceholder: 'Tìm kiếm...',
        filter: 'Lọc',
        all: 'Tất cả',
        favorites: 'Yêu thích',
        noHistoryYet: 'Chưa có lịch sử',
        noItemsFound: 'Không tìm thấy mục nào',
        enterTitleOptional: 'Nhập tiêu đề (tùy chọn)',
        save: 'Lưu',
        cancel: 'Hủy',
        copy: 'Sao chép',
        qr: 'QR',
        delete: 'Xóa',
        codeCopiedToClipboard: 'Mã đã được sao chép vào clipboard',
        error: 'Lỗi',
        cannotCopyToClipboard: 'Không thể sao chép vào clipboard',
        deleteConfirm: 'Bạn có chắc chắn muốn xóa mục này?',
        clearAllConfirm: 'Bạn có chắc chắn muốn xóa tất cả lịch sử?',
        pumlDiagram: 'Sơ đồ PUML',
        failedToGenerateQrCode: 'Không thể tạo mã QR',
        success: 'Thành công',
      },
      ai: {
        title: 'Trợ lý AI',
        startConversation: 'Bắt đầu cuộc trò chuyện với AI để tạo sơ đồ PlantUML. Hãy yêu cầu tôi tạo các sơ đồ như sơ đồ tuần tự, sơ đồ lớp, hoặc bất kỳ sơ đồ PlantUML nào khác.',
        you: 'Bạn',
        ai: 'AI',
        render: 'Kết xuất',
        error: 'Lỗi',
        askAiPlaceholder: 'Yêu cầu AI tạo sơ đồ PlantUML...',
        pleaseSetApiKey: 'Vui lòng đặt khóa API trong Cài đặt',
        pleaseSetApiBaseUrl: 'Vui lòng đặt URL cơ sở API trong Cài đặt',
        errorOccurredWhileGenerating: 'Đã xảy ra lỗi khi tạo',
        failedToRenderPumlCode: 'Không thể kết xuất mã PUML',
      },
      tabs: {
        pumlViewer: 'PUML Viewer',
        home: 'Trang chủ',
        ai: 'AI',
        aiAssistant: 'Trợ lý AI',
        history: 'Lịch sử',
        settings: 'Cài đặt',
        about: 'Giới thiệu',
      },
      pumlViewer: {
        title: 'PUML Viewer',
        loadingPumlDiagram: 'Đang tải sơ đồ PUML...',
        error: 'Lỗi',
        failedToLoadDiagram: 'Không thể tải sơ đồ',
        goToHome: 'Về trang chủ',
      },
      notFound: {
        title: 'Không tìm thấy',
        pageNotFound: 'Trang không tồn tại',
        oopsPageDoesNotExist: 'Ồ! Trang này không tồn tại.',
        pageNotFoundMessage: 'Trang bạn đang tìm không thể tìm thấy.',
        goToHome: 'Về trang chủ',
      },
    },
  },
};

const deviceLanguage = Localization.getLocales()[0]?.languageCode || 'en';
const initialLanguage = ['en', 'vi'].includes(deviceLanguage) ? deviceLanguage : 'en';

i18n
  .use(initReactI18next)
  .init({
    resources,
    lng: initialLanguage,
    fallbackLng: 'en',
    compatibilityJSON: 'v4',
    interpolation: {
      escapeValue: false,
    },
  });

/**
 * Get the current language code
 * @returns The current language code (e.g., 'en', 'vi')
 */
export function getLanguageCode(): string {
  return i18n.language || 'en';
}

export default i18n;

